{"version":3,"sources":["views/pages/authentication/register-multi-steps/steps/EmailVerification.js"],"names":["ToastContent","x","name","message","className","size","color","icon","onClick","toast","dismiss","id","ToastErrorContent","defaultValues","address","firstName","EmailVerification","stepper","t","useTranslation","useSkin","skin","useState","block","setBlock","setErrorInfo","setSuccessInfo","otp","setOtp","useForm","handleSubmit","control","setError","formState","errors","blocking","loader","onSubmit","data","every","value","params","parseInt","join","replaceAll","register_token","sessionStorage","getItem","useJwt","registerOtp","then","res","removeItem","setItem","next","catch","err","messageError","includes","response","error_reason","map","index","md","xs","type","maxLength","onChange","e","newOtp","target","nextInput","document","getElementById","focus","handleInputChange","onKeyDown","key","prevInput","handleKeyDown","style","width","height","textAlign","fontSize","fontWeight","outline","previous"],"mappings":"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","file":"static/js/160.7b0cba7a.chunk.js","sourcesContent":["import { useState, Fragment } from \"react\"\nimport { useForm } from \"react-hook-form\"\nimport { AlertCircle, ChevronLeft, Navigation, X, Check } from \"react-feather\"\nimport { Form, Input, Row, Col, Button } from \"reactstrap\"\n\nimport { useTranslation } from \"react-i18next\"\nimport toast from \"react-hot-toast\"\nimport Avatar from \"@components/avatar\"\nimport Spinner from \"@components/spinner/Fallback-spinner\"\nimport UILoader from \"@components/ui-loader\"\nimport { useSkin } from \"@hooks/useSkin\"\nimport useJwt from \"@src/auth/jwt/useJwt\"\n\nconst ToastContent = ({ x, name, message }) => {\n  return (\n    <div className=\"d-flex\">\n      <div className=\"me-1\">\n        <Avatar size=\"sm\" color=\"info\" icon={<Navigation size={12} />} />\n      </div>\n      <div className=\"d-flex flex-column\">\n        <div className=\"d-flex justify-content-between\">\n          <h6>{name}</h6>\n          <X\n            size={12}\n            className=\"cursor-pointer\"\n            onClick={() => toast.dismiss(x.id)}\n          />\n        </div>\n        <span>{message}</span>\n      </div>\n    </div>\n  )\n}\n\nconst ToastErrorContent = ({ x, name, message }) => {\n  return (\n    <div className=\"d-flex\">\n      <div className=\"me-1\">\n        <Avatar size=\"sm\" color=\"danger\" icon={<AlertCircle size={12} />} />\n      </div>\n      <div className=\"d-flex flex-column\">\n        <div className=\"d-flex justify-content-between\">\n          <h6>{name}</h6>\n          <X\n            size={12}\n            className=\"cursor-pointer\"\n            onClick={() => toast.dismiss(x.id)}\n          />\n        </div>\n        <span>{message}</span>\n      </div>\n    </div>\n  )\n}\n\nconst defaultValues = {\n  address: \"\",\n  firstName: \"\"\n}\n\nconst EmailVerification = ({ stepper }) => {\n  const { t } = useTranslation()\n  const { skin } = useSkin()\n  const [block, setBlock] = useState(false)\n  const [errorInfo, setErrorInfo] = useState(null)\n  const [successInfo, setSuccessInfo] = useState(null)\n  const [otp, setOtp] = useState([\"\", \"\", \"\", \"\"])\n\n  // ** Hooks\n  const {\n    control,\n    setError,\n    handleSubmit,\n    formState: { errors }\n  } = useForm({\n    defaultValues\n  })\n\n  const handleInputChange = (e, index) => {\n    const newOtp = [...otp]\n    newOtp[index] = e.target.value\n\n    // Move focus to the next input box if there's an entered value\n    if (e.target.value !== \"\" && index < 3) {\n      const nextInput = document.getElementById(`otpInput${index + 1}`)\n      if (nextInput) {\n        nextInput.focus()\n      }\n    }\n\n    setOtp(newOtp)\n  }\n\n  const handleKeyDown = (e, index) => {\n    if (e.key === \"Backspace\" && index > 0 && otp[index] === \"\") {\n      const newOtp = [...otp]\n      newOtp[index - 1] = \"\"\n      setOtp(newOtp)\n\n      const prevInput = document.getElementById(`otpInput${index - 1}`)\n      if (prevInput) {\n        prevInput.focus()\n      }\n    }\n  }\n\n  const onSubmit = (data) => {\n    if (otp?.every((value) => value !== \"\")) {\n      const params = {\n        otp: parseInt(otp.join()?.replaceAll(\",\", \"\")),\n        register_token: sessionStorage.getItem(\"register_token\")\n      }\n      setBlock(true)\n      useJwt\n        .registerOtp(params)\n        .then((res) => {\n          const data = res.data\n          setBlock(false)\n          setSuccessInfo(data?.message)\n          sessionStorage.removeItem(\"register_token\")\n          sessionStorage.setItem(\"register_token_msg\", data?.message)\n          toast((x) => (\n            <ToastContent\n              x={x}\n              name={t(\"Successfully\")}\n              message={data?.message}\n            />\n          ))\n          stepper.next()\n        })\n        .catch((err) => {\n          setBlock(false)\n          let messageError = `${t(\n            \"Failed. Please check your email and password and make sure your account is registered correctly. Contact our support team if needed.\"\n          )}`\n          if (\n            [\"email_taken\", \"username_taken\"].includes(\n              err.response?.data?.error_reason\n            )\n          ) {\n            messageError = err.response?.data?.message\n          }\n          setErrorInfo(messageError)\n          toast((x) => (\n            <ToastErrorContent\n              x={x}\n              name={t(\"Register Failed\")}\n              message={messageError}\n            />\n          ))\n        })\n    }\n  }\n\n  return (\n    <UILoader blocking={block} loader={<Spinner />}>\n      <Fragment>\n        <div className=\"content-header mb-2\">\n          <h2 className=\"fw-bolder mb-75\">{t(\"Email Verification\")}</h2>\n          <span>\n            {t(\"Enter the OTP code that we have sent to your email\")}.\n          </span>\n        </div>\n        <Form onSubmit={handleSubmit(onSubmit)}>\n          <Row>\n            {otp.map((value, index) => (\n              <Col md=\"2\" xs=\"3\" className=\"mb-1\">\n                <Input\n                  key={index}\n                  id={`otpInput${index}`}\n                  type=\"text\"\n                  maxLength=\"1\"\n                  value={value}\n                  onChange={(e) => handleInputChange(e, index)}\n                  onKeyDown={(e) => handleKeyDown(e, index)}\n                  style={{\n                    width: \"100%\",\n                    height: \"50px\",\n                    textAlign: \"center\",\n                    fontSize: \"25px\",\n                    fontWeight: 600\n                  }}\n                />\n              </Col>\n            ))}\n            <Col md=\"12\" className=\"mb-1\">\n              <span\n                style={{\n                  fontSize: \"smaller\",\n                  color: \"#999999\"\n                }}\n              >\n                {t(\n                  \"This OTP code has an expiration date. If your code is outdated, then repeat the registration process\"\n                )}\n                .\n              </span>\n            </Col>\n          </Row>\n\n          <div className=\"d-flex justify-content-between mt-2\">\n            <Button\n              color=\"secondary\"\n              className=\"btn-prev\"\n              outline\n              onClick={() => stepper.previous()}\n            >\n              <ChevronLeft\n                size={14}\n                className=\"align-middle me-sm-25 me-0\"\n              ></ChevronLeft>\n              <span className=\"align-middle d-sm-inline-block d-none\">\n                {t(\"Previous\")}\n              </span>\n            </Button>\n            {otp?.every((value) => value !== \"\") && (\n              <Button type=\"submit\" color=\"success\" className=\"btn-next\">\n                <span className=\"align-middle d-sm-inline-block d-none\">\n                  {t(\"Submit\")}\n                </span>\n                <Check size={14} className=\"align-middle ms-sm-25 ms-0\"></Check>\n              </Button>\n            )}\n          </div>\n        </Form>\n      </Fragment>\n    </UILoader>\n  )\n}\n\nexport default EmailVerification\n"],"sourceRoot":""}